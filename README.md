# AstrBot 插件：骗子酒馆 (Liar's Tavern - Revolver Poker AI Mode)

**版本:** 1.2.0

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
一款结合了吹牛、扑克元素和刺激左轮淘汰机制的多人在线卡牌游戏插件，专为 AstrBot 设计。现在支持添加 AI 玩家与你对战！在酒馆里，你需要胆识和策略才能生存下来！

## 游戏玩法

1.  **开局**: 玩家们（包括人类和 AI）加入游戏，系统会确定一个本轮的“主牌”(A, K, 或 Q 中的一种)。
2.  **出牌**: 轮到的玩家（或 AI）打出 1-3 张手牌，并 **声称** 这些牌都是当轮的“主牌”或万能的“鬼牌 (Joker)”。
3.  **反应**: 下一位玩家（或 AI）可以选择：
    * **质疑**: 不相信上一家的声称，要求亮牌。
    * **跟牌**: 相信（或假装相信）上一家的声称，继续打出自己的牌 (1-3张)，同样声称是主牌/鬼牌。
4.  **质疑结算**:
    * **声称属实**: 如果上一家出的确实都是主牌或鬼牌，则 **质疑者** 挑战失败，需要“开枪”！
    * **声称作假**: 如果上一家出的牌中包含非主牌/鬼牌，则 **出牌者** 吹牛被抓，需要“开枪”！
5.  **开枪**: 从一个装有少量实弹（默认为3发）和若干空弹的虚拟左轮手枪中随机抽取一发。抽中实弹者 **淘汰** 出局！
6.  **特殊情况**:
    * **手牌为空**: 如果轮到你（或 AI）时手牌已空，不能出牌，只能选择 `/质疑` 上一家或 `/等待` (跳过出牌，默认接受上一家的牌)。
    * **洗牌**: 当有玩家被淘汰，或者所有仍在场上的玩家手牌都打光时，会将所有弃牌和剩余手牌收集起来，重新洗牌、重新发牌、并确定新的主牌，游戏继续。
7.  **胜利**: 游戏持续进行，直到只剩下最后一名玩家（或 AI）存活，该玩家获得最终胜利！

## 如何开始玩

*(确保你的 AstrBot 实例已正确加载此插件，并配置了可用的 LLM Provider)*

1.  **创建游戏**: 在你想玩的 QQ 群里，由任意成员发送：
    `/骗子酒馆`
    (别名: `/pzjg`, `/liardice`)
    机器人会回复游戏创建成功和玩法说明。

2.  **加入游戏 (人类玩家)**: 其他想参与的玩家发送：
    `/加入`
    机器人会提示加入成功和当前人数。

3.  **添加 AI 玩家 (可选)**: 在等待阶段，可以添加 AI 对手：
    `/添加AI` (默认添加 1 个 AI)
    `/添加AI 数量` (例如 `/添加AI 2` 添加 2 个 AI)
    机器人会提示 AI 添加成功。

4.  **开始游戏**: 当玩家总人数（人类+AI）达到最低要求（默认为 2 人）后，通常由 **发起者** 发送：
    `/开始`
    游戏正式开始，机器人会公布本轮主牌、玩家顺序，并通过 **私聊** 发送初始手牌给每位 **人类** 玩家。AI 会自动开始行动。

## 游戏指令

* `/骗子酒馆` (别名: `/pzjg`, `/liardice`)
    * 功能：在当前群聊创建一局新游戏。

* `/加入`
    * 功能：**人类玩家** 加入当前群聊正在等待玩家的游戏。

* `/添加AI [数量]` (别名: `/addai`, `/加AI`)
    * 功能：在等待阶段向游戏中添加指定数量的 AI 对手 (默认 1 个)。

* `/开始`
    * 功能：开始游戏（需要达到最小玩家总数，通常由创建者发起）。

* `/出牌 <编号> [编号...]` (别名: `/play`, `/打出`)
    * 功能：轮到 **你 (人类玩家)** 时，打出 1-3 张手牌。编号对应你收到的私信或使用 `/我的手牌` 命令看到的手牌编号。
    * 示例：`/出牌 2` 或 `/出牌 1 3`

* `/质疑` (别名: `/challenge`, `/抓`)
    * 功能：轮到 **你 (人类玩家)** 时，质疑上一位玩家打出的牌并非全是主牌或鬼牌。

* `/等待` (别名: `/wait`, `/pass`, `/过`)
    * 功能：**仅当你 (人类玩家) 手牌为空时可用**。跳过你的出牌阶段，默认接受上一家的出牌。

* `/状态` (别名: `/status`, `/游戏状态`)
    * 功能：查看当前游戏状态，包括主牌、玩家顺序 (含 AI 标记)、剩余手牌数、当前轮到谁等信息。如果你是人类玩家，也会在群聊中提示你自己的手牌数量。

* `/我的手牌` (别名: `/hand`, `/手牌`)
    * 功能：让机器人通过 **私聊** 发送 **你 (人类玩家)** 当前的手牌和本轮主牌。

* `/结束游戏` (别名: `/endgame`, `/强制结束`)
    * 功能：强制立即结束当前群聊的游戏（可能需要管理员权限）。

## 注意事项

* **LLM 配置**: AI 玩家需要 AstrBot 配置好可用的大语言模型 (LLM Provider) 才能运行。如果未配置 LLM，AI 将无法正常决策（会使用简单的备用逻辑）。
* **私聊权限 (人类玩家)**: 请确保你 **添加了机器人为好友**，并且 **没有屏蔽** 来自机器নের消息。游戏需要通过私聊向你发送手牌信息，收不到私信将极大影响游戏体验！
* **出牌编号**: 人类玩家使用 `/出牌` 命令时，请务必使用机器人私信给你或通过 `/我的手牌` 查询到的 **最新** 手牌编号。
* **鬼牌 (Joker)**: Joker 是万能牌，在判断声称是否属实时，它等同于当前的主牌。
* **AI 行为**: AI 的决策基于 LLM 的分析和一定的随机性，其水平和策略取决于你配置的 LLM 模型。可以通过查看机器人后台日志了解 AI 的思考过程。

## 安装

对于普通用户，请在 AstrBot 的插件市场中寻找“骗子酒馆”并安装。

对于开发者或手动安装：
1.  将插件文件夹 `astrbot_plugin_liar_tavern` 放置于 AstrBot 的 `data/plugins` 目录下。
2.  重启 AstrBot 或在插件管理界面重新加载插件。
3.  (如果插件有额外依赖) 根据 `requirements.txt` 安装依赖：`pip install -r requirements.txt` (本插件目前似乎没有外部依赖)。

## 贡献

欢迎通过提 Issue 或 Pull Request (如果提供了仓库链接) 的方式贡献代码、报告 Bug 或提出建议。

## 许可证

本插件采用 [MIT](https://opensource.org/licenses/MIT) 许可证。